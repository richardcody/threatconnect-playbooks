{
  "allowOnDemand": true,
  "appId": "fd4eas3e-dae8-5617-abc1-4124d53851e5",
  "displayName": "Custom App - Abuse.ch MalwareBazaar",
  "features": [
    "secureParams"
  ],
  "languageVersion": "3.6",
  "listDelimiter": "|",
  "params": [
    {
      "label": "ThreatConnect Owner",
      "name": "tc_owner",
      "note": "The owner from which indicators and groups will be created",
      "required": true,
      "sequence": 1,
      "type": "Choice",
      "validValues": [
        "${OWNERS}"
      ]
    },
    {
      "name": "api_access_id",
      "label": "Local ThreatConnect API Access ID",
      "sequence": 2,
      "type": "String",
      "required": true,
      "validValues": [
        "${USER:TEXT}",
        "${ORGANIZATION:TEXT}"
      ]
    },
    {
      "name": "api_secret_key",
      "label": "Local ThreatConnect API Secret Key",
      "sequence": 3,
      "encrypt": true,
      "type": "String",
      "required": true,
      "validValues": [
        "${USER:KEYCHAIN}",
        "${ORGANIZATION:KEYCHAIN}"
      ]
    },
    {
      "label": "Threat Rating",
      "name": "rating",
      "note": "Threat Rating to apply to the ingested indicators",
      "required": true,
      "sequence": 4,
      "default": 3,
      "type": "Choice",
      "validValues": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5"
      ]
    },
    {
      "label": "Threat Confidence",
      "name": "confidence",
      "note": "Confidence Rating to apply to the ingested indicators, 0-100",
      "required": true,
      "default": "40",
      "sequence": 5,
      "type": "String",
      "validValues": [
        "${USER:TEXT}"
      ]
    },
    {
      "label": "Download malware samples?",
      "name": "download_malware_samples",
      "note": "If enabled, this will download the malware samples provided",
      "default": false,
      "required": false,
      "type": "Boolean",
      "sequence": 6
    },
    {
      "label": "Abuse.ch MalwareBazaar API Key",
      "name": "api_key",
      "encrypt": true,
      "note": "If download malware samples is checked, an API KEY is required.",
      "required": false,
      "default": "none",
      "type": "String",
      "validValues": [
        "${USER:KEYCHAIN}",
        "${ORGANIZATION:KEYCHAIN}",
        "${USER:TEXT}"
      ],
      "sequence": 7
    },
    {
      "label": "Selector Options",
      "name": "selector_options",
      "note": "time refers to malware over the last 60 minutes, 100 refers to the last 100 malware samples submitted",
      "required": true,
      "default": "time",
      "type": "Choice",
      "validValues": [
        "time",
        "100"
      ],
      "sequence": 8
    },
    {
      "label": "Demo Mode",
      "name": "demo_mode",
      "note": "If enabled, selector is forced to 100 to guarantee results, then only the first 2 items are iterated over",
      "required": false,
      "default": "False",
      "type": "Boolean",
      "sequence": 9
    },
    {
      "label": "Additional Tags",
      "name": "additional_tags",
      "note": "this takes a pipe (|) delimited list of additional tag(s) to apply to the ingested indicators/groups.",
      "required": false,
      "default": "malware|important",
      "type": "String",
      "validValues": [
        "${USER:TEXT}"
      ],
      "sequence": 10
    },
    {
      "name": "tc_log_level",
      "label": "Logging Level",
      "sequence": 11,
      "default": "info",
      "type": "Choice",
      "validValues": [
        "debug",
        "info",
        "warning",
        "error",
        "critical"
      ]
    }
  ],
  "programLanguage": "PYTHON",
  "programMain": "run",
  "programVersion": "1.0.0",
  "runtimeLevel": "Organization"
}