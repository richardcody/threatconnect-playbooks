{
  "programName": "TCAB_-_58a33a83-c91a-4963-be30-154bf082c17e",
  "displayName": "Abuse.ch MalwareBazaar",
  "programVersion": "2.0.0",
  "programLanguage": "PYTHON",
  "programMain": "run",
  "languageVersion": "3.7",
  "listDelimiter": "|",
  "runtimeLevel": "Playbook",
  "allowOnDemand": true,
  "allowRunAsUser": false,
  "apiUserTokenParam": false,
  "note": "This app will connect to the API from https://bazaar.abuse.ch/ and you have the options to download indicators/malware added over the last 60 minutes or the last 100 samples that have been submitted.\n\n*NOTE*: Downloading the samples requires an API key: https://bazaar.abuse.ch/api/#api_key where as just the indicator data is freely available.\n\nAs there are not always results for \"time\" within the last 60 minutes and to test the app, if Demo Mode is  enabled then only the first two results from the last 100 submitted will be processed.",
  "playbook": {
    "type": "Custom App",
    "outputVariables": []
  },
  "params": [
    {
      "name": "api_key",
      "type": "String",
      "label": "api key",
      "default": "",
      "allowMultiple": false,
      "encrypt": true,
      "required": false,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "This is the API key for Abuse.ch Malware Bazaar. https://bazaar.abuse.ch/api/#api_key",
      "sequence": 6,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "${TEXT}",
        "${KEYCHAIN}"
      ],
      "playbookDataType": [
        "String"
      ],
      "intelType": []
    },
    {
      "name": "download_malware_samples",
      "type": "Boolean",
      "label": "Download Malware samples?",
      "default": "false",
      "allowMultiple": false,
      "encrypt": false,
      "required": false,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "If enabled, the app will download and store the malware samples and associate them to the indicator. ",
      "sequence": 5,
      "serviceConfig": false,
      "setup": false,
      "validValues": [],
      "playbookDataType": [],
      "intelType": []
    },
    {
      "name": "rating",
      "type": "String",
      "label": "Rating",
      "default": "3",
      "allowMultiple": false,
      "encrypt": false,
      "required": true,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "This is the default Threat Rating to apply to the ingested indicators.",
      "sequence": 1,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "${TEXT}"
      ],
      "playbookDataType": [
        "String"
      ],
      "intelType": []
    },
    {
      "name": "confidence",
      "type": "String",
      "label": "Confidence",
      "default": "25",
      "allowMultiple": false,
      "encrypt": false,
      "required": true,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "This is the default confidence to apply to the ingested indicators.",
      "sequence": 2,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "${TEXT}"
      ],
      "playbookDataType": [
        "String"
      ],
      "intelType": []
    },
    {
      "name": "owner",
      "type": "String",
      "label": "Owner",
      "default": "abuse.ch MalwareBazaar",
      "allowMultiple": false,
      "encrypt": false,
      "required": true,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "Owner that the ingested indicators/documents are saved in.",
      "sequence": 0,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "${TEXT}"
      ],
      "playbookDataType": [
        "String"
      ],
      "intelType": []
    },
    {
      "name": "selector_option",
      "type": "Choice",
      "label": "Selector Option",
      "default": "recent",
      "allowMultiple": false,
      "encrypt": false,
      "required": true,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "The two valid options for download selector options:\n---- \u0027time\u0027 (malware added within the last 60 minutes)\n---- \u0027100\u0027 (100 most recent)\nhttps://bazaar.abuse.ch/api/#latest_additions",
      "sequence": 3,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "time",
        "100"
      ],
      "playbookDataType": [],
      "intelType": []
    },
    {
      "name": "additional_tags",
      "type": "String",
      "label": "Additional Tags",
      "default": "malware|important",
      "allowMultiple": false,
      "encrypt": false,
      "required": true,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "Accepts Pipe Delimited tags, ex: \"malware|important\"",
      "sequence": 4,
      "serviceConfig": false,
      "setup": false,
      "validValues": [
        "${TEXT}"
      ],
      "playbookDataType": [
        "String"
      ],
      "intelType": []
    },
    {
      "name": "demo_mode",
      "type": "Boolean",
      "label": "Demo Mode",
      "default": "false",
      "allowMultiple": false,
      "encrypt": false,
      "required": false,
      "hidden": false,
      "feedDeployer": false,
      "viewRows": 1,
      "note": "If enabled, only the first two results from the most recent 100 submitted samples will be downloaded and processed.",
      "sequence": 7,
      "serviceConfig": false,
      "setup": false,
      "validValues": [],
      "playbookDataType": [],
      "intelType": []
    }
  ],
  "feeds": [],
  "repeatingMinutes": [],
  "publishOutFiles": [],
  "runtimeContext": [],
  "features": [
    "secureParams",
    "appBuilderCompliant"
  ],
  "labels": []
}
